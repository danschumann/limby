<% extend @limby.layout('account') %>

<%- @breadcrumbs {'account': 'Account'} %>

<div class="<%- @limb.config.forms.account.containerClass %>">
  <form role="form" class="<%- @limb.config.forms.account.className %>" action="/account" method="post">

    <% @body ?= {first_name: '', last_name: ''} %>
    <% @user = @req.locals.user.toJSON() %>

    <div class="panel-heading">
      Edit Account
      <div class="pull-right bump-right">
        <a class="btn btn-default btn-sm push-right" href="/email">
          Change Email
        </a>
        <% if @limb.config.forms?.account?.password isnt false : %>
          <a class="btn btn-default btn-sm" href="/password">
            Change Password
          </a>
        <% end %>
      </div>
      <span class="glyphicon glyphicon-edit pull-right bump-down"></span>
    </div>

    <div class="panel-body pad-top-xl">

      <% @formGroup = [
        type: 'html'
        title: 'Email:'
        html: '
        <div class="marg-bottom-md">
          <strong class="inline-block push-down">' + @req.locals.user.get('email') + '</strong>
        </div>
        '
      ,
        title: 'First Name:'
        name: 'first_name'
        value: @body.first_name || @user.first_name
      ,
        title: 'Last Name:'
        name: 'last_name'
        value: @body.last_name || @user.last_name
      ] %>


      <% include @limby.viewPath('partials/form_group') %>

      <%- @limby.renderWidgets('account/index', this) %>

      <% @formGroup = [
        className: @limb.config.forms.email.buttonClass
        value: 'Save &raquo;'
        type: 'submit'
      ] %>
      <% include @limby.viewPath 'partials/form_group' %>
    </div>

  </form>
</div>
