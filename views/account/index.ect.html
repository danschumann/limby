<% extend @limby.layout('account') %>

<%- @breadcrumbs {'account': 'Account'} %>

<% include @limby.viewPath 'notifications' %>

<div class="<%- @limb.config.forms.account.containerClass %>">
  <form role="form" class="<%- @limb.config.forms.account.className %>" action="/account" method="post">

    <% @body ?= {first_name: '', last_name: ''} %>
    <% @user = @req.locals.user.toJSON() %>

    <div class="<%- @limb.config.forms.account.panelHeadingClass %>">
      <%- @limb.config.forms.account.panelHeading %>
      <div class="pull-right edit-actions">
        <span class="glyphicon glyphicon-edit"></span>
        <a class="btn btn-default btn-xs" href="/email">
          Change Email
        </a>
        <% if @limb.config.forms?.account?.password isnt false : %>
          <a class="btn btn-default btn-xs" href="/password">
            Change Password
          </a>
        <% end %>
      </div>
    </div>

    <div class="<%- @limb.config.forms.account.panelBodyClass %>">

      <% @formGroup = [
        type: 'html'
        title: 'Email:'
        html: '<strong class="inline-block pad-xs-top-7">' + @req.locals.user.get('email') + '</strong>'
      ,
        title: 'First Name:'
        name: 'first_name'
        value: @body.first_name || @user.first_name
      ,
        title: 'Last Name:'
        name: 'last_name'
        value: @body.last_name || @user.last_name
      ] %>

      <% include @limby.viewPath('partials/form_group') %>

      <%- @limby.renderWidgets('account/index', this) %>

      <% @formGroup = [
        className: @limb.config.forms.account.buttonClass
        value: @limb.config.forms.account.buttonText
        type: 'submit'
      ] %>
      <% include @limby.viewPath 'partials/form_group' %>
    </div>

  </form>
</div>
